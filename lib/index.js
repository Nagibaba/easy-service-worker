const _self=self;function LazySW(){const mainClass=this;CACHENAME="default-lazy-cache";resources=["/"];exclude=(url=>{return false});precache=(()=>{return caches.open(CACHENAME).then(function(cache){return cache.addAll(resources)})});fromCache=(request=>{return caches.open(CACHENAME).then(function(cache){return cache.match(request).then(function(matching){return matching||fetch(request).catch(error=>{return caches.match("/offline.html")})})})});update=(request=>{console.log("updatin",request);return caches.open(CACHENAME).then(function(cache){return fetch(request).then(function(response){if(response.status<300&&response.type==="basic"){return Promise.all([response.clone(),response.text()])}return[false,null]}).then(([response,text])=>{if(text){cache.match(request).then(matching=>matching?matching.text():null).then(function(cachedText){if(cachedText&&!stringsAreSame(text,cachedText)){cache.put(request,response.clone()).then(function(){refresh(response,[text.length,cachedText.length])})}else if(!cachedText){cache.put(request,response.clone()).then(function(){})}})}}).catch(error=>"Network failed")})});stringsAreSame=((a,b)=>{if(a.length!==b.length){return false}return a.localeCompare(b)===0});refresh=((response,info=null)=>{return _self.clients.matchAll().then(function(clients){clients.forEach(function(client){var message={type:"refresh",url:response.url,info:info};client.postMessage(JSON.stringify(message))})})});this.init=(()=>{_self.addEventListener("install",function(evt){console.log("The lazy service worker is being installed.");_self.skipWaiting();if(resources)evt.waitUntil(precache())});_self.addEventListener("activate",function(event){event.waitUntil(caches.keys().then(function(cacheNames){return Promise.all(cacheNames.filter(function(cacheName){return cacheName!==CACHENAME}).map(function(cacheName){return caches.delete(cacheName)}))}))});_self.addEventListener("fetch",function(evt){const cachableDestinations=["document","font","script","style","image"];const nonCachable=!(evt.request.url.indexOf("http")===0)||evt.request.destination!=="document"||evt.request.method=="POST"||evt.request.mode==="cors"||/[?]/.test(evt.request.url)||/favicon/.test(evt.request.url);if(exclude(evt.request.url)||nonCachable){return evt.respondWith(fetch(evt.request).catch(error=>console.log(error)))}evt.respondWith(fromCache(evt.request));evt.waitUntil(update(evt.request))})});this.init()}